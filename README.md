# Slider
#### H5专题总结
H5一直纠结我们一块的大项，他影响项目进度，我们要考虑把它拿下
梳理业务点:
- **屏数量很大的 **：swipe里面掺杂复杂动画 运行很卡的问题（超过10屏以上的）

- **缺少锁屏功能**：比如到一些特定的屏幕 不准滑动 ，这个swipe没有提供灵活的api，而且有时候更细化到 不能锁住向上 或者 向下的单方向滑动

- **swipe和iscroll嵌套使用 **：冒泡引起的滑动异常问题

- **slideTo 滑动 **：到指定屏的功能形式有点欠缺 会有闪屏的现象

- **多次滑动触控 **：单一屏幕 多次滑动触控 显示不同交互的问题（目前总是 总是划一下就进入下一页了）

- **当前状态的class标识**：缺少滑动到当前屏的特殊类class

- **翻转特效**：除了直板切换其实还可以形成 3D立体翻转 缩放翻转 等其他形式

for_zj.js 核心意图，专注解决H5专题开发中遇到的各种业务棘手问题，目前性能方面采用动态加载屏数的方式，每次滚动只加载对应页的当前屏和上下两屏，通过动态插入的方式来环节，类似时尚网这种因页面过多导致的性能溢出的问题。

### 使用
**HTML结构**

    <div id="wrap">
		<div class="item item1">
            <div class="item-inner">
                <!-- item-inner里包含你写的所有代码 -->
                <img src="images/clock.png">
            </div>
        </div>
		<div class="item item2">
            <div class="item-inner">
                <!-- item-inner里包含你写的所有代码 -->
            </div>      
        </div>
		<div class="item item3">
            <div class="item-inner">
                <!-- item-inner里包含你写的所有代码 -->
            </div>      
        </div>
		<div class="item item4">
            <div class="item-inner">
                <!-- item-inner里包含你写的所有代码 -->
            </div>      
        </div>
	</div>

**css样式**

    /*此处是插件必须的css*/
    #wrap{height: 100%;}
    .item{ position: absolute;left: 0;top: 0;width: 100%;height: 100%;overflow: hidden;-webkit-transition: -webkit-transform .3s ease-out;}

**js调用**

    <script type="text/javascript" src="for_zj.js"></script>
    <script type="text/javascript">
        var mySlide=new touchSlider();
    </script>

---
[Demo 源码下载](demo.html)   
 [应用扩展](demo.html)

**参数设置**
- **container** ： 表示当前外围包裹整个切换模块的元素，选填，默认为“#wrap”
- **curClass** ： 表示当前屏处理交互动画的统一类，选填，默认为“play”
- **item** ： 表示每一个滑动块的统一class类名，选填，默认为“.item”
-  **preDistance** ： 表示滑动块移动的触发范围，选填，默认为25像素（手指从触碰到屏幕到脱离屏幕 竖直Y轴的差值，表示你的滑动幅度）
-  **speed** ： 表示每一个滑动块的滑动速度，选填，默认为300ms
-  **slideCallback** ： 表示手离开触发点且滑动块改变时触发
-  **touchCallback** ： 表示检测到当前屏有多次触控效果的时候 触发的函数

**API**
- **slideTo()** ：滑动块的索引值,即从*值开始滑动，默认为0
- **prev()**：滑动到上一页
- **next()**：滑动到下一页

**插件属性**
- **_prev** ：获取当前屏的上一屏的dom节点
-  **_next** ：获取当前屏的下一屏的dom节点
-  **_current** ：获取当前屏的dom节点
-  **index** ：获取当前屏的索引，默认从0开始
-  **_lockToNext** ：单向锁下屏功能，默认为false关闭，true开启
-  **_lockToPrev** ：单向锁上屏功能，默认为false关闭，true开启
-  **_lockToSlide** ：双向锁屏功能，默认为false关闭，true开启

**注意事项**：因为此插件 使用的是动态插入节点的方式，所以对于新手进行事件绑定的时候要小心，以防绑定事件丢失，所以选择适合自己的东西

**常见问题指引**：
**1、做H5我很慌，不知道从哪里下手，切图怎么处理？百分比定位总感觉要算半天，很浪费时间 怎么解决？**
大家注意一下demo页面头部的head区域引入的一段js，具体代码不详解，作用就是解决大家比较纠结的切图和定位问题，我们的设计稿PSD一般均以640的宽度为标准进行绘制，之前的方法，所是以取二倍图并缩放一半的方式进行编码，采用该动态script，可以以实际大小进行绘制 也不用担心定位的问题，量取是多少像素就写多少像素，一切自适应交给手机自动去缩放完成

    
	// 此处添加如下js 可以避免二倍图和百分比定位造成的不便
	if(/Android (\d+\.\d+)/.test(navigator.userAgent)){
    var version = parseFloat(RegExp.$1);
    if(version>2.3){
        var phoneScale = parseInt(window.screen.width)/640;
        document.write('<meta name="viewport" content="width=640, minimum-scale = '+ phoneScale +', maximum-scale = '+ phoneScale +', target-densitydpi=device-dpi">');
    }else{
        document.write('<meta name="viewport" content="width=640, target-densitydpi=device-dpi">');
    }
	}else{
    document.write('<meta name="viewport" content="width=640, user-scalable=no, target-densitydpi=device-dpi,minimal-ui">');
	}
	

**2、不会写那些炫酷的效果怎么办？**
答：效果是一个积累的过程，除了本身对css3的诸多属性很了解之外，还要有一定的设计能力、并能把用户提供的需求转换成计算机能懂的程序语言，这需要清楚动画的很多过程 了解其中的原理，对于新手来说有一定难度；

然后万事并不都是绝对，可喜可贺的是，作为需求方 要么给我们特殊的例子 否则他们也很难言明具体效果为何物，此时我们可以充分利用animate.css库类提供的效果或者日常我们总结或者收集的效果，从中选择特切主题的效果 加以运用，时尚网90%的效果 都可以通过animate.css来搞定


**3、如何解决屏数过多和动画过多导致的性能问题**
答：此插件采用的是动态插入的方式，来加载的页面，每次滑动只会动态插入当前屏以及上下屏共三屏内容，通过此方法来解决屏数过多导致的问题

**4、是否有锁屏功能，锁屏功能一般在什么时候会使用？**
答：此插件提供了单向和双向的锁屏功能，使用方法 请参考上面的插件属性。
使用场景：
A 当页面中内嵌用调查代码或者问卷调查之类的东西，需要引导用户一一完成作答才能开始后面的内容，并且用户可以任意修改之前的选项答案，那么就需要应用到单向滑动

B 根绝需求的具体业务不同 一些以引导性或者叙事性为主的专题 也会通过锁屏的方式 引导用户看完所有内容

C 通过锁屏的方式 可以解决iscroll 冒泡的问题，目前我们多以弹层的方式作为解决的方式，通过新建一个独立于该插件的弹层来解决模拟滚动条的问题，但是当业务较为复杂或者弹层位置相对分散的时候 锁屏就会变得很有用，同时也有利于编辑的内容填充；或者当模拟滚动条是局部显示的时候 锁屏也会变得比较有用
如下图所示：
![Alt text](./123.png)

**5、我屏幕都锁住了 那我还怎么进入下一页**
答：该插件内置封装了prev()、next()方法，该方法可以跟锁屏相结合，在你具体业务需要的任意时候 去调用

**6、公司的lazy.js是否可以应用到专题中来，以提高页面的性能和加载速度？**
答：不行，lazy.js的原理注定他是适用于直板网站级页面，通过全局遍历出图片相对于全局的坐标值，根据滚动到对应位置出相应区块的内容，而wap专题不管是swipe还是我这款，其余的2345678屏内容都是叠在一块的 不具备相对高度，如果强行使用 也是一次性加载出来了所有图片 跟没用是一个样。

**7、那专题方面，提高页面的性能和加载速度应该做哪些工作？**
答：专题的提升我大致理解为两块
A、**图片加载，**一般是在一个可控的范围内，所以可以考虑初期添加loading的动画加载前面所需的图片，loading动画在用户体验方面是可以接受的，然后之后的图片可以再后台默默加载，不影响用户的使用方式。

B、**内容加载**，内容的加载是有技巧的，举例专题为了在有限的空间内展示更多的信息和元素会采用弹窗的方式，有些新人遇到这种问题 习惯性给每个元素都创建一个div，然后只是采用简单的block和none的方式简单的重复显示 这无疑给页面添加了很多额外的多余内容，此处其实可以采用模板化的方式来填写，这块有机会再细说

**8、滑屏的插件这么多 有swipe又有swiper iscroll，你现在又搞一个，那我到底用哪一个？**
答：插件本身都不是问题，好与坏也是相对的，有些是业务包容性不够，有些是脱离具体业务太多，所以根据自己的情况和专题本身的需求 选择适合的插件即可

**8、多此触控的效果是什么东西**
答：此处赘述 不一定能明白，等遇到具体需求 可跟我沟通，时尚网之后也会提供相应的一些案例链接 即可看懂

新手建议：
- 掌握meta设置的特殊方式 避免二倍图和百分比定位带来的痛苦
- 掌握animate.css中的动画 多交互组合 在插件中的应用
- 多看一些效果demo 掌握属性转换的一些方法和形式
- 多借鉴他人页面 资源链接内部共享
- 多掌握一些插件的使用，减少相似交互的开发成本，将主要精力集中在特定业务的需求上来，从而达到提高开发效率的目的



